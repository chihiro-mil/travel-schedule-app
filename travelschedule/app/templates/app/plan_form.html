{% extends 'app/base.html' %}
{% load static %}

{% block title %}Plan form page {% endblock %}

{% block extra_head %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'app/css/plan_form.css' %}">
{% endblock %}

{% block content %}
<a href="{% url 'app:schedule_detail' schedule_id=schedule.id %}"class="back-button">＜戻る</a>

<div class="container">
    <h2>予定の{{ form_title }}</h2>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-group">
            {{ form.action_category.label_tag }}
            {{ form.action_category }}
        </div>

        <div class="form-group">
            {{ form.name.label_tag }}
            {{ form.name }}
        </div>

        <div class="form-group" id="trip-date-field">
            {{ form.trip_date.label_tag }}
            {{ form.trip_date }}
        </div>

        <div class="form-group" id="start-time-field">
            {{ form.start_time.label_tag }}
            {{ form.start_time }}
        </div>

        <div class="form-group" id="end-time-field">
            {{ form.end_time.label_tag }}
            {{ form.end_time }}
        </div>

        <div class="form-group">
            {{ form.memo.label_tag }}
            {{ form.memo }}
        </div>

        <div class="form-group">
            {{ form.departure_location.label_tag }}
            {{ form.departure_location }}
        </div>

        <div class="form-group">
            {{ form.arrival_location.label_tag }}
            {{ form.arrival_location }}
        </div>

        <!-- リンク・画像・移動手段　後で追加予定 -->

        <button type="submit" class="btn btn-primary">保存</button>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const categorySelect = document.getElementById('id_action_category');
        const tripDateField = document.getElementById('trip-date-field');
        const startTimeField = document.getElementById('start-time-field');
        const endTimeField = document.getElementById('end-time-field');

        const tripDateLabel = tripDateField.querySelector('label');
        const startTimeField = startTimeField.querySelector('label');
        const endTimeField = endTimeField.querySelector('label');

        function updateFields() {
            const selected = categorySelect.value;

            tripDateField.style.display = 'block';
            startTimeField.style.display = 'block';
            endTimeField.style.display = 'block';

            if (selected === '移動') {
                tripDateLabel.textContent = '出発日';
                startTimeLabel.textContent = '出発時刻';
                endTimeLabel.textContent = '到着時刻';
            } else if (selected === '観光地') {
                tripDateLabel.textContent = '滞在開始日';
                startTimeLabel.textContent = '滞在開始時刻';
                endTimeLabel.textContent = '滞在終了時刻';
            } else if (selected === '食事') {
                tripDateLabel.textContent = '食事日';
                startTimeLabel.textContent = '食事開始時刻';
                endTimeLabel.textContent = '食事終了時刻'; 
            } else if (selected === '宿泊') {
                tripDateLabel.textContent = '滞在日';
                startTimeLabel.textContent = '滞在開始時刻';
                endTimeLabel.textContent = '滞在終了時刻'; 
            }
        }

        categorySelect.addEventListener('change', updateFields);
        updateFields();
    });
</script>
{% endblock %}