{% extends 'app/base.html' %}
{% load static %}

{% block title %}{{ form_title }}page{% endblock %}

{% block extra_head %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'app/css/plan_form.css' %}">
{% endblock %}

{% block content %}
<a href="{% url 'app:schedule_detail' schedule_id=schedule.id %}"class="back-button">＜戻る</a>

<div class="container">
    <h2>予定の{{ form_title }}</h2>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="form-group">
            {{ form.action_category.label_tag }}
            {{ form.action_category }}
        </div>

        <div class="form-group">
            {{ form.name.label_tag }}
            {{ form.name }}
        </div>

    <div id="datetime-fields">
        <div class="form-group" id="start-date-group">
            <label id="start-date-label">開始日</label>
            {{ form.trip_date }}
        </div>

        <div class="form-group" id="start-time-group">
            <label id="start-time-label">開始時刻</label>
            {{ form.start_time }}
        </div>

        <div class="form-group" id="end-date-group">
            <label id="end-date-group">終了日</label>
            {{ form.end_date }}
        </div>

        <div class="form-group" id="end-time-group">
            <label id="end-time-group">終了時刻</label>
            {{ form.end_time }}
        </div>
    </div>

        <div class="form-group">
            {{ form.memo.label_tag }}
            {{ form.memo }}
        </div>

        <div class="form-group">
            {{ form.departure_location.label_tag }}
            {{ form.departure_location }}
        </div>

        <div class="form-group">
            {{ form.arrival_location.label_tag }}
            {{ form.arrival_location }}
        </div>

        <!-- リンク・画像・移動手段　後で追加予定 -->

        <button type="submit" class="btn btn-primary">保存</button>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const categoryField = document.querySelector("#id_action_category");
    const startDateLabel = document.getElementById("start-date-label");
    const startTimeLabel = document.getElementById("start-time-label");
    const endDateLabel = document.getElementById("end-date-label");
    const endTimeLabel = document.getElementById("end-time-label");

    function updateLabels() {
        const selected = categoryField.value;

        if (!selected) {
            datetimeFields.style.display = "none";
            return;
        }

        datetimeFields.style.display = "block";

        if (selected === "移動") {
                startDateLabel.textContent = "出発日";
                startTimeLabel.textContent = "出発時刻";
                endDateLabel.textContent = "到着日";
                endTimeLabel.textContent = "到着時刻";
            } else if (selected === "観光地") {
                startDateLabel.textContent = "滞在開始日";
                startTimeLabel.textContent = "滞在開始時";
                endDateLabel.textContent = "滞在終了日";
                endTimeLabel.textContent = "滞在終了時刻";
            } else if (selected === "食事") {
                startDateLabel.textContent = "食事日";
                startTimeLabel.textContent = "食事開始時刻";
                endTimeLabel.textContent = "食事終了時刻"; 
            } else if (selected === "宿泊") {
                startDateLabel.textContent = "滞在開始日";
                startTimeLabel.textContent = "滞在開始時刻";
                endDateLabel.textContent = "滞在終了日";
                endTimeLabel.textContent = "滞在終了時刻"; 
            }
        }

        updateLabels();
        categoryField.addEventListener("change", updateLabels);
    });
</script>
{% endblock %}